---
title: "Práctica de ruido"
output:
  pdf_document: default
  html_notebook: default
  word_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
require("gdata")
library(gdata)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
```{r}
rlun<-read.xls("lun_cuba_10min.xls",header=FALSE)
```

```{r}
head(rlun)
```

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

Asigno los nombres a las columnas del 'data.frame'.
```{r}
colnames(rlun) <- c("time", "intensidad")

```
## 3. Represento los datos:

Como es una serie temporal, puedo utilizar la siguiente función:

```{r}
ts.plot(rlun[2], type='o', ylab='intensidad')
```

La función ts.plot considera el que el argumento que se le introduce es una series temporal y lo representa como tal. Esta función acepta como argumentos 'type' para cambiar el tipo de representación y distintos argumentos para insertar el título y el nombre en los ejes.

Puedo utilizar también la funcín 'plot' del base de R. En este caso, tengo que indicar los valores de x e y que quiero representar.

```{r}
plot(rlun[1:144,2], type='b', ylab='intensidad', xlab='time index')
```

## 4. Cálculo de índices de ruido

Nivel de ruido equivalente diario: Leqdiario

```{r}
t1<-10^(rlun[2]/10)
deltat<-10.
t2<-sum(deltat*t1)
leqlunes<-10*log10(1/(60*24)*t2)
```

Leq diurno: 43 a 114, de 7 a 19h: 12h
Leq tarde: 115 a 138:  19 a 23: 4 h
Leq nocturno: 1 a 42 y 139 a 144: 0 a 7 y 23 a 24: 8h

Cálculo del Leq diurno
```{r}
t1d<-10^(rlun[43:114,2]/10)
t2d<-sum(deltat*t1d)
leqdlunes<-10*log10(1/(60*12)*t2d)
```
Cálculo del Leq de la tarde

```{r}
t1t<-10^(rlun[115:138,2]/10)
t2t<-sum(deltat*t1t)
leqtlunes<-10*log10(1/(60*4)*t2t)
```

Cálculo del Leq nocturno

```{r}
t1n1<-10^(rlun[1:42,2]/10)
t1n2<-10^(rlun[139:144,2]/10)
t2n<-sum(deltat*t1n1)+sum(deltat*t1n2)
leqnlunes<-10*log10(1/(60*8)*t2n)
```

Cállculo del ruido equivalente total:

```{r}
ttd=10^(leqdlunes/10)
ttt=10^((leqtlunes+5)/10)
ttn=10^((leqnlunes+10)/10)
ldn=10*log10((12*ttd+4*ttt+8*ttn)/24)

```

## 5. Cálculo de los percentiles:

```{r}
rlunesp90<-quantile(rlun[,2],0.9)
rlunesp10<-quantile(rlun[,2],0.1)
tni<-4*(rlunesp90-rlunesp10)+rlunesp10-30
```

